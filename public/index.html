<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>MT5 Auto Trader</title>
<style>
body { font-family: Arial; text-align:center; padding:20px; background:#f5f5f5;}
input, button, select { padding:10px; margin:5px;}
#log {margin-top:20px; text-align:left; max-width:600px; margin:auto; background:#fff; padding:10px; border-radius:8px;}
table {width:100%; border-collapse: collapse;}
th, td {border: 1px solid #ccc; padding: 8px; text-align:center;}
th {background:#eee;}
</style>
</head>
<body>
<h1>üìà MT5 Auto Trader</h1>

<div>
<input id="username" placeholder="Username">
<input id="password" type="password" placeholder="Password">
<button onclick="register()">Register</button>
<button onclick="login()">Login</button>
</div>

<hr>

<div>
<select id="symbol">
<option value="EURUSD">EURUSD</option>
<option value="GBPUSD">GBPUSD</option>
<option value="USDJPY">USDJPY</option>
<option value="AUDUSD">AUDUSD</option>
</select>
<input id="lot" type="number" placeholder="Lot size" value="0.1" step="0.1">
<button onclick="placeOrder('buy')">Buy</button>
<button onclick="placeOrder('sell')">Sell</button>
</div>

<div id="log">
<h3>üìã Orders Log</h3>
<table>
<thead>
<tr><th>Type</th><th>Symbol</th><th>Lot</th><th>Side</th></tr>
</thead>
<tbody id="orders-table"></tbody>
</table>
</div>

<script>
const BASE_URL = window.location.origin + "/api";

function logOrder(order) {
const table = document.getElementById("orders-table");
const row = table.insertRow();
row.insertCell(0).innerText = order.type;
row.insertCell(1).innerText = order.symbol;
row.insertCell(2).innerText = order.lot;
row.insertCell(3).innerText = order.side;
}

async function register() {
let username = document.getElementById("username").value;
let password = document.getElementById("password").value;
await fetch(`${BASE_URL}/register`, {
method:"POST",
headers:{"Content-Type":"application/json"},
body: JSON.stringify({username,password})
});
alert("‚úÖ Registered");
}

async function login() {
let username = document.getElementById("username").value;
let password = document.getElementById("password").value;
let res = await fetch(`${BASE_URL}/login`, {
method:"POST",
headers:{"Content-Type":"application/json"},
body: JSON.stringify({username,password})
});
let data = await res.json();
localStorage.setItem("token", data.token);
alert("‚úÖ Logged in");
}

async function placeOrder(side) {
let token = localStorage.getItem("token");
if(!token){ alert("‚ùå Login first"); return; }
const symbol = document.getElementById("symbol").value;
const lot = parseFloat(document.getElementById("lot").value);
const order = {type:"open", symbol, lot, side};
let res = await fetch(`${BASE_URL}/orders`, {
method:"POST",
headers:{"Content-Type":"application/json","Authorization":`Bearer ${token}`},
body: JSON.stringify(order)
});
await res.text();
logOrder(order);
}
</script>
</body>
</html>